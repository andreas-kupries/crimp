# -*- tcl -*-
# -------------------------------------------------------------------------

source [file join \
            [file dirname [file join [pwd] [info script]]] \
            testutilities.tcl]

testsNeedTcl     8.5
testsNeedTcltest 2

support { useLocalFile synth.tcl }
support { useC [mainPath _test/lib]/crimp_core* crimp::core no }
testing { useC [mainPath _test/lib]/crimp*      crimp       no }

# -------------------------------------------------------------------------
## Geometry manipulation. Warp basics (points, geometries).
# -------------------------------------------------------------------------

test crimp-warp-base-0.0 {image warp, wrong\#args} -body {
    crimp warp
} -returnCodes error -result {wrong # args: should be "crimp warp subcommand ?argument ...?"}

test crimp-warp-base-0.1 {image warp, invalid method} -body {
    crimp warp BOGUS
} -returnCodes error -result {unknown or ambiguous subcommand "BOGUS": must be box, field, point, or projective}


# -------------------------------------------------------------------------

test crimp-warp-point-1.0 {image warp point, wrong\#args, not enough} -body {
    crimp warp point
} -returnCodes error -result {wrong # args: should be "crimp warp point transform ..."}

test crimp-warp-point-1.1 {image warp point, invalid transform} -body {
    crimp warp point T
} -returnCodes error -result {expected projective transform but got "T"}

test crimp-warp-point-1.2 {image warp point, invalid point} -body {
    crimp warp point [crimp transform reflect line {2 4} {4 0}] X
} -returnCodes error -result {wrong # args: should be "crimp::warp_point forwardObj x y"}

test crimp-warp-point-1.3 {image warp point, invalid point} -body {
    crimp warp point [crimp transform reflect line {2 4} {4 0}] {X 1}
} -returnCodes error -result {expected floating-point number but got "X"}

test crimp-warp-point-1.4 {image warp point, invalid point} -body {
    crimp warp point [crimp transform reflect line {2 4} {4 0}] {1 Y}
} -returnCodes error -result {expected floating-point number but got "Y"}



# -------------------------------------------------------------------------

test crimp-warp-box-1.0 {image warp box, wrong\#args, not enough} -body {
    crimp warp box
} -returnCodes error -result {wrong # args: should be "crimp warp box transform geometry"}

test crimp-warp-box-1.1 {image warp box, wrong\#args, not enough} -body {
    crimp warp box T
} -returnCodes error -result {wrong # args: should be "crimp warp box transform geometry"}

test crimp-warp-box-1.2 {image warp box, wrong\#args, too many} -body {
    crimp warp box T G toomuch
} -returnCodes error -result {wrong # args: should be "crimp warp box transform geometry"}

test crimp-warp-box-1.3 {image warp box, invalid transform} -body {
    crimp warp box T G
} -returnCodes error -result {expected projective transform but got "T"}

test crimp-warp-box-1.4 {image warp box, invalid box} -body {
    crimp warp box [crimp transform reflect line {2 4} {4 0}] G
} -returnCodes error -result {wrong # args: should be "crimp::warp_box forwardObj x y w h"}

test crimp-warp-box-1.5 {image warp box, invalid box} -body {
    crimp warp box [crimp transform reflect line {2 4} {4 0}] {X 1 5 5}
} -returnCodes error -result {expected integer but got "X"}

test crimp-warp-box-1.6 {image warp box, invalid box} -body {
    crimp warp box [crimp transform reflect line {2 4} {4 0}] {1 Y 5 5}
} -returnCodes error -result {expected integer but got "Y"}

test crimp-warp-box-1.7 {image warp box, invalid box} -body {
    crimp warp box [crimp transform reflect line {2 4} {4 0}] {1 1 W 5}
} -returnCodes error -result {expected integer but got "W"}

test crimp-warp-box-1.8 {image warp box, invalid box} -body {
    crimp warp box [crimp transform reflect line {2 4} {4 0}] {1 1 5 H}
} -returnCodes error -result {expected integer but got "H"}

# -------------------------------------------------------------------------
testsuiteCleanup

# Local variables:
# mode: tcl
# indent-tabs-mode: nil
# End:
