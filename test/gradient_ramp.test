# -*- tcl -*-
# -------------------------------------------------------------------------

source [file join \
            [file dirname [file join [pwd] [info script]]] \
            testutilities.tcl]

testsNeedTcl     8.5
testsNeedTcltest 2

support { useLocalFile synth.tcl }
support { useC [mainPath _test/lib]/crimp_core* crimp::core no }
testing { useC [mainPath _test/lib]/crimp*      crimp       no }

# -------------------------------------------------------------------------
## Image generation: Gradients.
## - all types
## TODO: actual gradients/ramps
# -------------------------------------------------------------------------

set n 0
foreach itype [types] {
    test crimp-gradient-ramp-1.0.$n "[origin] image gradient ramp generation, $itype, wrong\#args, not enough" -body {
        crimp gradient $itype
    } -returnCodes error -result "wrong # args: should be \"crimp gradient $itype s e size\""

    test crimp-gradient-ramp-1.1.$n "[origin] image gradient ramp generation, $itype, wrong\#args, not enough" -body {
        crimp gradient $itype S
    } -returnCodes error -result "wrong # args: should be \"crimp gradient $itype s e size\""

    test crimp-gradient-ramp-1.2.$n "[origin] image gradient ramp generation, $itype, wrong\#args, not enough" -body {
        crimp gradient $itype S E
    } -returnCodes error -result "wrong # args: should be \"crimp gradient $itype s e size\""

    test crimp-gradient-ramp-1.3.$n "[origin] image gradient ramp generation, $itype, wrong\#args, too many" -body {
        crimp gradient $itype S E STEPS toomuch
    } -returnCodes error -result "wrong # args: should be \"crimp gradient $itype s e size\""

    test crimp-gradient-ramp-1.4.$n "[origin] image gradient ramp generation, $itype, invalid arguments" -body {
        crimp gradient $itype S E 1
    } -returnCodes error -result {expected size >= 2, got "1"}

    continue
    # Known bugs

    test crimp-gradient-ramp-1.5.$n "[origin] image gradient ramp generation, $itype, invalid arguments" -body {
        crimp gradient $itype S E STEPS
    } -returnCodes error -result {}

    test crimp-gradient-ramp-1.6.$n "[origin] image gradient ramp generation, $itype, invalid arguments" -body {
        crimp gradient $itype S E 2
    } -returnCodes error -result {}

    incr n
}

# -------------------------------------------------------------------------

# -------------------------------------------------------------------------
## Handling of location: generated images always at coordinate null/zero.

foreach {n itype x cando} {
    0 grey8     0 {}
    1 grey16    0 {}
    2 grey32    0 {}
    3 rgb       {0 0 0}   {}
    4 rgba      {0 0 0 0} {}
    5 hsv       {0 0 0}   {}
    6 float     0 {}
    7 fpcomplex {0 0} {}
} {
    test crimp-gradient-ramp-5.$n "image gradient ramp generation, $itype, location handling" -body {
	crimp at [crimp gradient $itype $x $x 2]
    } -result {0 0} -constraints $cando
}

# -------------------------------------------------------------------------
testsuiteCleanup

# Local variables:
# mode: tcl
# indent-tabs-mode: nil
# End:
