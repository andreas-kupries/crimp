# add.test -*- tcl -*-
# -------------------------------------------------------------------------

source [file join \
            [file dirname [file join [pwd] [info script]]] \
            testutilities.tcl]

testsNeedTcl     8.5
testsNeedTcltest 2

#support { useLocal synth.tcl }
support { useC [mainPath _test/lib]/crimp_core* crimp::core no }
testing { useC [mainPath _test/lib]/crimp*      crimp       no }

# -------------------------------------------------------------------------
## Creating of various types of blank images.
##
## XXX NOTE XXX This may be something for crimp::core instead of crimp.
# -------------------------------------------------------------------------

test crimp-blank-1.0 {Blank images, wrong\#args, not enough} -body {
    crimp blank
} -cleanup {
} -returnCodes error -result {wrong # args: should be "crimp blank type w h ..."}

test crimp-blank-1.1 {Blank images, wrong\#args, not enough} -body {
    crimp blank TYPE
} -cleanup {
} -returnCodes error -result {wrong # args: should be "crimp blank type w h ..."}

test crimp-blank-1.2 {Blank images, wrong\#args, not enough} -body {
    crimp blank TYPE W
} -cleanup {
} -returnCodes error -result {wrong # args: should be "crimp blank type w h ..."}

test crimp-blank-1.3 {Blank images, bogus image type} -body {
    crimp blank BOGUS W H
} -cleanup {
} -returnCodes error -result {Unable to create blank images of type "BOGUS"}

# -------------------------------------------------------------------------
# TODO: rgb, rgba, hsv, fpcomplex.
# -------------------------------------------------------------------------

test crimp-blank-2.0 {Blank images, grey8, wrong\#args, not enough} -body {
    crimp blank grey8 W H
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_grey8 w h value"}

test crimp-blank-2.1 {Blank images, grey8, wrong\#args, too many} -body {
    crimp blank grey8 W H VALUE toomuch
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_grey8 w h value"}

test crimp-blank-2.2 {Blank images, grey8, bogus dimensions} -body {
    crimp blank grey8 W H VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "W"}

test crimp-blank-2.3 {Blank images, grey8, bogus dimensions} -body {
    crimp blank grey8 3 H VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "H"}

test crimp-blank-2.4 {Blank images, grey8, bogus dimensions} -body {
    crimp blank grey8 3 4 VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "VALUE"}

test crimp-blank-2.5 {Blank images, grey8} -body {
    crimp write 2string tcl [crimp blank grey8 3 4 0]
} -result {{0 0 0} {0 0 0} {0 0 0} {0 0 0}}

test crimp-blank-2.6 {Blank images, grey8} -body {
    crimp write 2string tcl [crimp blank grey8 3 4 255]
} -result {{255 255 255} {255 255 255} {255 255 255} {255 255 255}}

test crimp-blank-2.7 {Blank images, grey8} -body {
    crimp write 2string tcl [crimp blank grey8 3 4 128]
} -result {{128 128 128} {128 128 128} {128 128 128} {128 128 128}}

test crimp-blank-2.8 {Blank images, grey8, wrap around} -body {
    crimp write 2string tcl [crimp blank grey8 3 4 256]
} -result {{0 0 0} {0 0 0} {0 0 0} {0 0 0}}

test crimp-blank-2.9 {Blank images, grey8, wrap around} -body {
    crimp write 2string tcl [crimp blank grey8 3 4 -1]
} -result {{255 255 255} {255 255 255} {255 255 255} {255 255 255}}

test crimp-blank-2.10 {Blank images, grey8, empty} -body {
    crimp write 2string tcl [crimp blank grey8 0 0 0]
} -result {}

test crimp-blank-2.11 {Blank images, grey8, empty} -body {
    crimp write 2string tcl [crimp blank grey8 3 0 0]
} -result {}

test crimp-blank-2.12 {Blank images, grey8, empty} -body {
    crimp write 2string tcl [crimp blank grey8 0 4 0]
} -result {}

test crimp-blank-2.13 {Blank images, grey8, bad dimensions} -body {
    crimp blank grey8 1 -1 0
} -returnCodes error -result {Illegal height, expected positive integer, got "-1"}

test crimp-blank-2.14 {Blank images, grey8, bad dimensions} -body {
    crimp blank grey8 -1 1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

test crimp-blank-2.15 {Blank images, grey8, bad dimensions} -body {
    crimp blank grey8 -1 -1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

# -------------------------------------------------------------------------

test crimp-blank-3.0 {Blank images, grey16, wrong\#args, not enough} -body {
    crimp blank grey16 W H
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_grey16 w h value"}

test crimp-blank-3.1 {Blank images, grey16, wrong\#args, too many} -body {
    crimp blank grey16 W H VALUE toomuch
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_grey16 w h value"}

test crimp-blank-3.2 {Blank images, grey16, bogus dimensions} -body {
    crimp blank grey16 W H VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "W"}

test crimp-blank-3.3 {Blank images, grey16, bogus dimensions} -body {
    crimp blank grey16 3 H VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "H"}

test crimp-blank-3.4 {Blank images, grey16, bogus dimensions} -body {
    crimp blank grey16 3 4 VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "VALUE"}

test crimp-blank-3.5 {Blank images, grey16} -body {
    crimp write 2string tcl [crimp blank grey16 3 4 0]
} -result {{0 0 0} {0 0 0} {0 0 0} {0 0 0}}

test crimp-blank-3.6 {Blank images, grey16} -body {
    crimp write 2string tcl [crimp blank grey16 3 4 65535]
} -result {{65535 65535 65535} {65535 65535 65535} {65535 65535 65535} {65535 65535 65535}}

test crimp-blank-3.7 {Blank images, grey16} -body {
    crimp write 2string tcl [crimp blank grey16 3 4 32767]
} -result {{32767 32767 32767} {32767 32767 32767} {32767 32767 32767} {32767 32767 32767}}

test crimp-blank-3.8 {Blank images, grey16, wrap around} -body {
    crimp write 2string tcl [crimp blank grey16 3 4 65536]
} -result {{0 0 0} {0 0 0} {0 0 0} {0 0 0}}

test crimp-blank-3.9 {Blank images, grey16, wrap around} -body {
    crimp write 2string tcl [crimp blank grey16 3 4 -1]
} -result {{65535 65535 65535} {65535 65535 65535} {65535 65535 65535} {65535 65535 65535}}

test crimp-blank-3.10 {Blank images, grey16, empty} -body {
    crimp write 2string tcl [crimp blank grey16 0 0 0]
} -result {}

test crimp-blank-3.11 {Blank images, grey16, empty} -body {
    crimp write 2string tcl [crimp blank grey16 3 0 0]
} -result {}

test crimp-blank-3.12 {Blank images, grey16, empty} -body {
    crimp write 2string tcl [crimp blank grey16 0 4 0]
} -result {}

test crimp-blank-3.13 {Blank images, grey16, bad dimensions} -body {
    crimp blank grey16 1 -1 0
} -returnCodes error -result {Illegal height, expected positive integer, got "-1"}

test crimp-blank-3.14 {Blank images, grey16, bad dimensions} -body {
    crimp blank grey16 -1 1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

test crimp-blank-3.15 {Blank images, grey16, bad dimensions} -body {
    crimp blank grey16 -1 -1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

# -------------------------------------------------------------------------

test crimp-blank-4.0 {Blank images, grey32, wrong\#args, not enough} -body {
    crimp blank grey32 W H
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_grey32 w h value"}

test crimp-blank-4.1 {Blank images, grey32, wrong\#args, too many} -body {
    crimp blank grey32 W H VALUE toomuch
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_grey32 w h value"}

test crimp-blank-4.2 {Blank images, grey32, bogus dimensions} -body {
    crimp blank grey32 W H VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "W"}

test crimp-blank-4.3 {Blank images, grey32, bogus dimensions} -body {
    crimp blank grey32 3 H VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "H"}

test crimp-blank-4.4 {Blank images, grey32, bogus dimensions} -body {
    crimp blank grey32 3 4 VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "VALUE"}

test crimp-blank-4.5 {Blank images, grey32} -body {
    crimp write 2string tcl [crimp blank grey32 3 4 0]
} -result {{0 0 0} {0 0 0} {0 0 0} {0 0 0}}

test crimp-blank-4.6 {Blank images, grey32} -body {
    crimp write 2string tcl [crimp blank grey32 3 4 4294967295]
} -result {{4294967295 4294967295 4294967295} {4294967295 4294967295 4294967295} {4294967295 4294967295 4294967295} {4294967295 4294967295 4294967295}}

test crimp-blank-4.7 {Blank images, grey32} -body {
    crimp write 2string tcl [crimp blank grey32 3 4 2147483648]
} -result {{2147483648 2147483648 2147483648} {2147483648 2147483648 2147483648} {2147483648 2147483648 2147483648} {2147483648 2147483648 2147483648}}

test crimp-blank-4.8 {Blank images, grey32, wrap around} -body {
    crimp write 2string tcl [crimp blank grey32 3 4 4294967296]
} -result {{0 0 0} {0 0 0} {0 0 0} {0 0 0}} \
    -constraints {KnownBug Overflow Internal}

test crimp-blank-4.9 {Blank images, grey32, wrap around} -body {
    crimp write 2string tcl [crimp blank grey32 3 4 -1]
} -result {{4294967295 4294967295 4294967295} {4294967295 4294967295 4294967295} {4294967295 4294967295 4294967295} {4294967295 4294967295 4294967295}}

test crimp-blank-4.10 {Blank images, grey32, empty} -body {
    crimp write 2string tcl [crimp blank grey32 0 0 0]
} -result {}

test crimp-blank-4.11 {Blank images, grey32, empty} -body {
    crimp write 2string tcl [crimp blank grey32 3 0 0]
} -result {}

test crimp-blank-4.12 {Blank images, grey32, empty} -body {
    crimp write 2string tcl [crimp blank grey32 0 4 0]
} -result {}

test crimp-blank-4.13 {Blank images, grey32, bad dimensions} -body {
    crimp blank grey32 1 -1 0
} -returnCodes error -result {Illegal height, expected positive integer, got "-1"}

test crimp-blank-4.14 {Blank images, grey32, bad dimensions} -body {
    crimp blank grey32 -1 1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

test crimp-blank-4.15 {Blank images, grey32, bad dimensions} -body {
    crimp blank grey32 -1 -1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

# -------------------------------------------------------------------------

test crimp-blank-5.0 {Blank images, float, wrong\#args, not enough} -body {
    crimp blank float W H
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_float w h value"}

test crimp-blank-5.1 {Blank images, float, wrong\#args, too many} -body {
    crimp blank float W H VALUE toomuch
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_float w h value"}

test crimp-blank-5.2 {Blank images, float, bogus dimensions} -body {
    crimp blank float W H VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "W"}

test crimp-blank-5.3 {Blank images, float, bogus dimensions} -body {
    crimp blank float 3 H VALUE
} -cleanup {
} -returnCodes error -result {expected integer but got "H"}

test crimp-blank-5.4 {Blank images, float, bogus dimensions} -body {
    crimp blank float 3 4 VALUE
} -cleanup {
} -returnCodes error -result {expected floating-point number but got "VALUE"}

test crimp-blank-5.5 {Blank images, float} -body {
    crimp write 2string tcl [crimp blank float 3 4 0]
} -result {{0.0 0.0 0.0} {0.0 0.0 0.0} {0.0 0.0 0.0} {0.0 0.0 0.0}}

test crimp-blank-5.6 {Blank images, float} -body {
    crimp write 2string tcl [crimp blank float 3 4 1]
} -result {{1.0 1.0 1.0} {1.0 1.0 1.0} {1.0 1.0 1.0} {1.0 1.0 1.0}}

test crimp-blank-5.7 {Blank images, float} -body {
    crimp write 2string tcl [crimp blank float 3 4 -1]
} -result {{-1.0 -1.0 -1.0} {-1.0 -1.0 -1.0} {-1.0 -1.0 -1.0} {-1.0 -1.0 -1.0}}

test crimp-blank-5.8 {Blank images, float} -body {
    crimp write 2string tcl [crimp blank float 3 4 0.5]
} -result {{0.5 0.5 0.5} {0.5 0.5 0.5} {0.5 0.5 0.5} {0.5 0.5 0.5}}

test crimp-blank-5.9 {Blank images, float} -body {
    F %.2f [crimp write 2string tcl [crimp blank float 3 4 0.33]]
} -result {{0.33 0.33 0.33} {0.33 0.33 0.33} {0.33 0.33 0.33} {0.33 0.33 0.33}}

test crimp-blank-5.10 {Blank images, float, empty} -body {
    crimp write 2string tcl [crimp blank float 0 0 0]
} -result {}

test crimp-blank-5.11 {Blank images, float, empty} -body {
    crimp write 2string tcl [crimp blank float 3 0 0]
} -result {}

test crimp-blank-5.12 {Blank images, float, empty} -body {
    crimp write 2string tcl [crimp blank float 0 4 0]
} -result {}

test crimp-blank-5.13 {Blank images, float, bad dimensions} -body {
    crimp blank float 1 -1 0
} -returnCodes error -result {Illegal height, expected positive integer, got "-1"}

test crimp-blank-5.14 {Blank images, float, bad dimensions} -body {
    crimp blank float -1 1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

test crimp-blank-5.15 {Blank images, float, bad dimensions} -body {
    crimp blank float -1 -1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

# -------------------------------------------------------------------------

test crimp-blank-6.0 {Blank images, rgb, wrong\#args, not enough} -body {
    crimp blank rgb W H
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_rgb w h r g b"}

test crimp-blank-6.1 {Blank images, rgb, wrong\#args, too many} -body {
    crimp blank rgb W H R G B toomuch
} -cleanup {
} -returnCodes error -result {wrong # args: should be "blank_rgb w h r g b"}

test crimp-blank-6.2 {Blank images, rgb, bogus dimensions} -body {
    crimp blank rgb W H R G B
} -cleanup {
} -returnCodes error -result {expected integer but got "W"}

test crimp-blank-6.3 {Blank images, rgb, bogus dimensions} -body {
    crimp blank rgb 3 H R G B
} -cleanup {
} -returnCodes error -result {expected integer but got "H"}

test crimp-blank-6.4 {Blank images, rgb, bogus dimensions} -body {
    crimp blank rgb 3 4 R G B
} -cleanup {
} -returnCodes error -result {expected integer but got "R"}

test crimp-blank-6.5 {Blank images, rgb, bogus dimensions} -body {
    crimp blank rgb 3 4 5 G B
} -cleanup {
} -returnCodes error -result {expected integer but got "G"}

test crimp-blank-6.6 {Blank images, rgb, bogus dimensions} -body {
    crimp blank rgb 3 4 5 6 B
} -cleanup {
} -returnCodes error -result {expected integer but got "B"}

test crimp-blank-6.7 {Blank images, rgb} -body {
    crimp write 2string tcl [crimp blank rgb 3 4 0 1 2]
} -result {{{0 1 2} {0 1 2} {0 1 2}} {{0 1 2} {0 1 2} {0 1 2}} {{0 1 2} {0 1 2} {0 1 2}} {{0 1 2} {0 1 2} {0 1 2}}}

test crimp-blank-6.8 {Blank images, rgb, auto-fill} -body {
    crimp write 2string tcl [crimp blank rgb 3 4 255]
} -result {{{255 0 0} {255 0 0} {255 0 0}} {{255 0 0} {255 0 0} {255 0 0}} {{255 0 0} {255 0 0} {255 0 0}} {{255 0 0} {255 0 0} {255 0 0}}}

test crimp-blank-6.9 {Blank images, rgb, wrap around} -body {
    crimp write 2string tcl [crimp blank rgb 3 4 256 257 258]
} -result {{{0 1 2} {0 1 2} {0 1 2}} {{0 1 2} {0 1 2} {0 1 2}} {{0 1 2} {0 1 2} {0 1 2}} {{0 1 2} {0 1 2} {0 1 2}}}

test crimp-blank-6.10 {Blank images, rgb, wrap around} -body {
    crimp write 2string tcl [crimp blank rgb 3 4 -1 -2 -3]
} -result {{{255 254 253} {255 254 253} {255 254 253}} {{255 254 253} {255 254 253} {255 254 253}} {{255 254 253} {255 254 253} {255 254 253}} {{255 254 253} {255 254 253} {255 254 253}}}

test crimp-blank-6.11 {Blank images, rgb, empty} -body {
    crimp write 2string tcl [crimp blank rgb 0 0 0]
} -result {}

test crimp-blank-6.12 {Blank images, rgb, empty} -body {
    crimp write 2string tcl [crimp blank rgb 3 0 0]
} -result {}

test crimp-blank-6.13 {Blank images, rgb, empty} -body {
    crimp write 2string tcl [crimp blank rgb 0 4 0]
} -result {}

test crimp-blank-6.14 {Blank images, rgb, bad dimensions} -body {
    crimp blank rgb 1 -1 0
} -returnCodes error -result {Illegal height, expected positive integer, got "-1"}

test crimp-blank-6.15 {Blank images, rgb, bad dimensions} -body {
    crimp blank rgb -1 1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

test crimp-blank-6.16 {Blank images, rgb, bad dimensions} -body {
    crimp blank rgb -1 -1 0
} -returnCodes error -result {Illegal width, expected positive integer, got "-1"}

# -------------------------------------------------------------------------
testsuiteCleanup

# Local variables:
# mode: tcl
# indent-tabs-mode: nil
# End:
